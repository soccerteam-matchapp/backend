name: Deploy to Cloudtype

on:
  push:
    branches: [dev, main]
  workflow_dispatch: {}

concurrency:
  group: cloudtype-${{ github.ref }}
  cancel-in-progress: true

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      # (선택) Node/PNPM 캐시 등 CI 단계가 필요하면 여기서 수행
      # - uses: actions/setup-node@v4
      #   with: { node-version: 18 }

      - name: Deploy to Cloudtype
        uses: cloudtype-github-actions/deploy@v1
        with:
  token: ${{ secrets.CLOUDTYPE_TOKEN }}
  project: sportly/sportly  # 예: soccerteam-matchapp/backend (대시보드에서 실제 값 확인)
  stage: dev
  file: app.yaml                  # ← 여기로 변경(.cloudtype/app.yaml 아님)
