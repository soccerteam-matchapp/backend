openapi: 3.0.3
info:
  title: 'Sportly API'
  version: 1.0.0
  description: 'Sportly 백엔드 API (status/message/data 응답 포맷)'
servers:
  -
    url: 'https://{host}'
    variables:
      host:
        default: 'localhost:3000'
tags:
  -
    name: Auth
  -
    name: Team
  -
    name: Match
  -
    name: Phone
  -
    name: Notification
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  responses:
    BadRequest:
      description: 'Bad Request'
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/BaseResponse'
          examples:
            bad:
              value:
                status: 400
                message: '요청 형식이 올바르지 않습니다.'
                data: null
                error: bad_request
    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/BaseResponse'
          examples:
            unauthorized:
              value:
                status: 401
                message: '인증이 필요합니다.'
                data: null
                error: unauthorized
    Forbidden:
      description: Forbidden
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/BaseResponse'
          examples:
            forbidden:
              value:
                status: 403
                message: '권한이 없습니다.'
                data: null
                error: forbidden
    Conflict:
      description: Conflict
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/BaseResponse'
          examples:
            conflict:
              value:
                status: 409
                message: '리소스 충돌'
                data: null
                error: conflict
    NotFound:
      description: 'Not Found'
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/BaseResponse'
          examples:
            notFound:
              value:
                status: 404
                message: '리소스를 찾을 수 없습니다.'
                data: null
                error: not_found
    ServerError:
      description: 'Server Error'
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/BaseResponse'
          examples:
            error:
              value:
                status: 500
                message: '서버 오류'
                data: null
                error: server_error
  schemas:
    BaseResponse:
      type: object
      properties:
        status:
          type: integer
          example: 200
        message:
          type: string
          example: OK
        data: {}
        error:
          type: string
          nullable: true
          example: null
      required:
        - status
        - message
        - data
    RegisterRequest:
      type: object
      properties:
        id:
          type: string
          example: soccer123
        name:
          type: string
          example: 정혜원
        password:
          type: string
          minLength: 8
          example: secret12
        username:
          type: string
          description: 'username를 보내면 내부적으로 name으로 매핑 처리'
      required:
        - id
        - password
    LoginRequest:
      type: object
      properties:
        id:
          type: string
        password:
          type: string
      required:
        - id
        - password
    RefreshRequest:
      type: object
      properties:
        refreshToken:
          type: string
      required:
        - refreshToken
    UserPublic:
      type: object
      properties:
        id:
          type: string
          description: '사용자 _id(ObjectId)'
        name:
          type: string
        role:
          type: string
          enum:
            - member
            - leader
      required:
        - id
        - name
        - role
    LoginData:
      type: object
      properties:
        accessToken:
          type: string
        refreshToken:
          type: string
        user:
          $ref: '#/components/schemas/UserPublic'
      required:
        - accessToken
        - refreshToken
        - user
    TokensData:
      type: object
      properties:
        accessToken:
          type: string
        refreshToken:
          type: string
      required:
        - accessToken
        - refreshToken
    Team:
      type: object
      properties:
        id:
          type: string
          description: '팀 _id'
        teamName:
          type: string
        inviteCode:
          type: string
          description: 6자리
        leader:
          type: string
          description: '팀장 _id'
        memberNum:
          type: integer
        canMatch:
          type: boolean
          description: '멤버 9명 이상이면 true'
      required:
        - id
        - teamName
        - inviteCode
        - leader
        - memberNum
        - canMatch
    TeamJoinDecision:
      type: object
      properties:
        accept:
          type: array
          items:
            type: string
            description: '수락할 사용자 _id'
        reject:
          type: array
          items:
            type: string
            description: '거절할 사용자 _id'
      required:
        - accept
        - reject
    PhoneRequest:
      type: object
      properties:
        phone:
          type: string
          description: 'E.164 (예: +821012345678)'
          example: '+821012345678'
      required:
        - phone
    PhoneVerifyRequest:
      type: object
      properties:
        phone:
          type: string
          example: '+821012345678'
        code:
          type: string
          example: '123456'
      required:
        - phone
        - code
    PhoneVerifyData:
      type: object
      properties:
        verified:
          type: boolean
          example: true
        expiresAt:
          type: string
          format: date-time
          nullable: true
    Match:
      type: object
      properties:
        id:
          type: string
        hostTeamId:
          type: string
        guestTeamId:
          type: string
          nullable: true
        date:
          type: string
          format: date-time
          description: '경기 일시(ISO8601)'
        place:
          type: string
        skillLevel:
          type: string
          example: intermediate
        exProCount:
          type: integer
          example: 1
          description: '선출 인원수'
        fieldCost:
          type: integer
          example: 120000
          description: 구장비(원)
        guestCostShare:
          type: integer
          example: 60000
          description: '게스트 팀 부담비용(원)'
        gameFormat:
          type: string
          example: '11v11 · 45min x2'
        isMatched:
          type: boolean
        createdAt:
          type: string
          format: date-time
      required:
        - id
        - hostTeamId
        - date
        - place
        - isMatched
    MatchCreateRequest:
      type: object
      properties:
        date:
          type: string
          format: date-time
        place:
          type: string
        skillLevel:
          type: string
        exProCount:
          type: integer
        fieldCost:
          type: integer
        guestCostShare:
          type: integer
        gameFormat:
          type: string
      required:
        - date
        - place
    MatchApplyRequest:
      type: object
      properties:
        guestTeamId:
          type: string
          description: '신청하는 게스트 팀 _id'
      required:
        - guestTeamId
    MatchDecideRequest:
      type: object
      properties:
        guestTeamId:
          type: string
        accept:
          type: boolean
      required:
        - guestTeamId
        - accept
    MatchCreateRequestV2:
      type: object
      properties:
        teamId:
          type: string
          description: '호스트 팀 _id'
        date:
          type: string
          format: date-time
        location:
          type: string
        players:
          type: integer
          description: '필요한 인원수'
      required:
        - teamId
        - date
        - location
        - players
    MatchApplyRequestV2:
      type: object
      properties:
        teamId:
          type: string
          description: '신청하는 게스트 팀 _id'
        matchId:
          type: string
          description: '매칭 _id'
        players:
          type: integer
          description: '참가 인원수'
      required:
        - teamId
        - matchId
        - players
    MatchAcceptRequest:
      type: object
      properties:
        matchId:
          type: string
        teamId:
          type: string
          description: '수락할 게스트 팀 _id'
      required:
        - matchId
        - teamId
    TeamRatingRequest:
      type: object
      properties:
        score:
          type: number
          minimum: 0
          maximum: 5
          description: '평점 (0~5)'
        comment:
          type: string
          maxLength: 500
          description: '댓글 (선택)'
      required:
        - score
    TeamRatingSummary:
      type: object
      properties:
        averageScore:
          type: number
          description: '평균 평점'
        totalCount:
          type: integer
          description: '평점 개수'
        scoreDistribution:
          type: object
          description: '점수별 분포'
    TeamRatingItem:
      type: object
      properties:
        id:
          type: string
        rater:
          type: object
          properties:
            id:
              type: string
            name:
              type: string
        score:
          type: number
        comment:
          type: string
          nullable: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - id
        - score
        - createdAt
        - updatedAt
    TeamRatingListResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/TeamRatingItem'
        nextCursor:
          type: string
          nullable: true
          description: '다음 페이지 커서'
      required:
        - data
    NotificationItem:
      type: object
      properties:
        id:
          type: string
        type:
          type: string
          enum:
            - team_join_request
            - match_apply
            - match_accepted
        title:
          type: string
        message:
          type: string
        read:
          type: boolean
        createdAt:
          type: string
          format: date-time
        relatedTeam:
          type: object
          nullable: true
          properties:
            id:
              type: string
            teamName:
              type: string
        relatedMatch:
          type: object
          nullable: true
          properties:
            id:
              type: string
            date:
              type: string
            location:
              type: string
        relatedUser:
          type: object
          nullable: true
          properties:
            id:
              type: string
            name:
              type: string
      required:
        - id
        - type
        - title
        - message
        - read
        - createdAt
    NotificationCount:
      type: object
      properties:
        count:
          type: integer
          example: 3
      required:
        - count
paths:
  /auth/register:
    post:
      tags:
        - Auth
      summary: 회원가입
      description: "회원을 생성합니다. `username`을 보내도 내부에서 `name`으로 매핑되어 처리됩니다.\n"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
            examples:
              default:
                value:
                  id: soccer123
                  name: 정혜원
                  password: secret12
              allowUsernameAlias:
                value:
                  id: soccer123
                  username: 정혜원
                  password: secret12
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {nullable: true, example: null}}}
              examples:
                created:
                  value: {status: 201, message: '회원가입 성공', data: null}
        '400':
          $ref: '#/components/responses/BadRequest'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/ServerError'
  /auth/login:
    post:
      tags:
        - Auth
      summary: 로그인
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
            examples:
              default:
                value:
                  id: soccer123
                  password: secret12
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {$ref: '#/components/schemas/LoginData'}}}
              examples:
                ok:
                  value: {status: 200, message: '로그인 성공', data: {accessToken: eyJhbGciOi..., refreshToken: eyJhbGciOi..., user: {id: 66c7e2d2f3a4f2bb1e8e1b11, name: 정혜원, role: member}}}
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/ServerError'
  /auth/refresh:
    post:
      tags:
        - Auth
      summary: '토큰 재발급'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RefreshRequest'
            examples:
              default:
                value:
                  refreshToken: eyJhbGciOi...
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {$ref: '#/components/schemas/TokensData'}}}
              examples:
                ok:
                  value: {status: 200, message: '토큰 재발급 성공', data: {accessToken: new-access-token, refreshToken: new-refresh-token}}
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/ServerError'
  /teams:
    post:
      tags:
        - Team
      summary: '팀 만들기(초대코드 발급)'
      security:
        -
          BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                teamName:
                  type: string
              required:
                - teamName
            examples:
              default:
                value:
                  teamName: 'FC Tools'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {type: object, properties: {id: {type: string, description: '팀 _id'}, teamName: {type: string}, inviteCode: {type: string, description: '6자리 초대코드'}, leader: {type: string, description: '팀장 _id'}, memberNum: {type: integer}, canMatch: {type: boolean, description: '멤버 9명 이상이면 true'}}, required: [id, teamName, inviteCode, leader, memberNum, canMatch]}}}
              examples:
                created:
                  value: {status: 201, message: '팀 생성 성공', data: {id: 66cc7a7f0c2e3a1234567890, teamName: 'FC Tools', inviteCode: '123456', leader: 66c7e2d2f3a4f2bb1e8e1b11, memberNum: 1, canMatch: false}}
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/ServerError'
  '/teams/invite/{code}':
    get:
      tags:
        - Team
      summary: '초대코드로 팀 조회'
      description: '초대코드로 팀 기본 정보를 조회합니다.'
      security:
        -
          BearerAuth: []
      parameters:
        -
          in: path
          name: code
          required: true
          schema:
            type: string
          description: '발급된 6자리 초대코드'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {type: object, properties: {id: {type: string}, teamName: {type: string}, inviteCode: {type: string}, memberNum: {type: integer}, canMatch: {type: boolean}}, required: [id, teamName, inviteCode, memberNum, canMatch]}}}
              examples:
                ok:
                  value: {status: 200, message: '팀 조회 성공', data: {id: 66cc7a7f0c2e3a1234567890, teamName: 'FC Tools', inviteCode: '123456', memberNum: 1, canMatch: false}}
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          description: 'Not Found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BaseResponse'
              examples:
                notFound:
                  value: {status: 404, message: '해당 초대코드의 팀을 찾을 수 없습니다.', data: null, error: not_found}
        '500':
          $ref: '#/components/responses/ServerError'
  /teams/join:
    post:
      tags:
        - Team
      summary: '초대코드로 가입 요청'
      security:
        -
          BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                inviteCode:
                  type: string
              required:
                - inviteCode
            examples:
              default:
                value:
                  inviteCode: '123456'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {type: object, properties: {teamId: {type: string}, pendingCount: {type: integer}}, required: [teamId, pendingCount]}}}
              examples:
                ok:
                  value: {status: 200, message: '가입 요청 접수', data: {teamId: 66cc7a7f0c2e3a1234567890, pendingCount: 1}}
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          description: 'Not Found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BaseResponse'
              examples:
                notFound:
                  value: {status: 404, message: '해당 초대코드의 팀을 찾을 수 없습니다.', data: null, error: not_found}
        '500':
          $ref: '#/components/responses/ServerError'
  '/teams/{teamId}/requests':
    get:
      tags:
        - Team
      summary: '가입 대기 목록(팀장 전용)'
      security:
        -
          BearerAuth: []
      parameters:
        -
          in: path
          name: teamId
          required: true
          schema:
            type: string
            description: '팀 _id(ObjectId)'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {type: array, items: {type: object, properties: {_id: {type: string}, name: {type: string}, id: {type: string, description: '로그인 아이디(username)'}}, required: [_id, name, id]}}}}
              examples:
                ok:
                  value: {status: 200, message: '가입 대기 목록', data: [{_id: 66c7e2d2f3a4f2bb1e8e1b11, name: 김철수, id: cs123}]}
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BaseResponse'
              examples:
                forbidden:
                  value: {status: 403, message: '팀장만 확인할 수 있습니다.', data: null, error: forbidden}
        '404':
          description: 'Not Found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BaseResponse'
              examples:
                notFound:
                  value: {status: 404, message: '팀을 찾을 수 없습니다.', data: null, error: not_found}
        '500':
          $ref: '#/components/responses/ServerError'
  '/teams/{teamId}/requests/decide':
    post:
      tags:
        - Team
      summary: '가입 요청 일괄 수락/거절(팀장 전용)'
      security:
        -
          BearerAuth: []
      parameters:
        -
          in: path
          name: teamId
          required: true
          schema:
            type: string
            description: '팀 _id(ObjectId)'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                accept:
                  type: array
                  items: {type: string, description: '수락할 사용자 _id'}
                reject:
                  type: array
                  items: {type: string, description: '거절할 사용자 _id'}
              required:
                - accept
                - reject
            examples:
              acceptSome:
                value:
                  accept: [66c7e2d2f3a4f2bb1e8e1b11]
                  reject: []
              rejectSome:
                value:
                  accept: []
                  reject: [66c7e2d2f3a4f2bb1e8e1b22]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {type: object, properties: {teamId: {type: string}, memberNum: {type: integer}, canMatch: {type: boolean}, accepted: {type: integer}, rejected: {type: integer}, remainingPending: {type: integer}}, required: [teamId, memberNum, canMatch, accepted, rejected, remainingPending]}}}
              examples:
                ok:
                  value: {status: 200, message: '처리 완료', data: {teamId: 66cc7a7f0c2e3a1234567890, memberNum: 9, canMatch: true, accepted: 1, rejected: 0, remainingPending: 2}}
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BaseResponse'
              examples:
                forbidden:
                  value: {status: 403, message: '팀장만 처리할 수 있습니다.', data: null, error: forbidden}
        '404':
          description: 'Not Found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BaseResponse'
              examples:
                notFound:
                  value: {status: 404, message: '팀을 찾을 수 없습니다.', data: null, error: not_found}
        '500':
          $ref: '#/components/responses/ServerError'
  '/teams/{teamId}/ratings':
    post:
      tags:
        - Team
      summary: '팀 평점 생성/수정'
      security:
        -
          BearerAuth: []
      description: '팀에 대한 평점을 생성하거나 수정합니다. (upsert)'
      parameters:
        -
          in: path
          name: teamId
          required: true
          schema:
            type: string
            description: '팀 _id(ObjectId)'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TeamRatingRequest'
            examples:
              default:
                value:
                  score: 4
                  comment: '매너 좋은 팀입니다!'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {type: object, properties: {id: {type: string}, team: {type: string}, rater: {type: string}, score: {type: number}, comment: {type: string, nullable: true}, createdAt: {type: string, format: date-time}, updatedAt: {type: string, format: date-time}}}}}
              examples:
                ok:
                  value: {status: 200, message: '평점 저장', data: {id: 66e0..., team: 66cc..., rater: 66c7..., score: 4, comment: '매너 좋은 팀입니다!', createdAt: '2025-09-12T10:00:00+09:00', updatedAt: '2025-09-12T10:00:00+09:00'}}
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/ServerError'
    get:
      tags:
        - Team
      summary: '팀 평점 목록 조회'
      description: '팀에 대한 평점 목록을 커서 기반 페이지네이션으로 조회합니다.'
      parameters:
        -
          in: path
          name: teamId
          required: true
          schema:
            type: string
            description: '팀 _id(ObjectId)'
        -
          in: query
          name: limit
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
          description: '조회할 개수'
        -
          in: query
          name: cursor
          schema:
            type: string
          description: '다음 페이지 커서 (이전 요청의 nextCursor 사용)'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {type: array, items: {$ref: '#/components/schemas/TeamRatingItem'}}, nextCursor: {type: string, nullable: true}}}
              examples:
                ok:
                  value: {status: 200, message: '평점 목록', data: [{id: 66e0..., rater: {id: 66c7..., name: 정혜원}, score: 4, comment: '매너 좋은 팀입니다!', createdAt: '2025-09-12T10:00:00+09:00', updatedAt: '2025-09-12T10:00:00+09:00'}], nextCursor: 66e0...}
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/ServerError'
  '/teams/{teamId}/ratings/summary':
    get:
      tags:
        - Team
      summary: '팀 평점 요약 조회'
      description: '팀의 평균 평점, 총 개수, 점수별 분포를 조회합니다.'
      parameters:
        -
          in: path
          name: teamId
          required: true
          schema:
            type: string
            description: '팀 _id(ObjectId)'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {$ref: '#/components/schemas/TeamRatingSummary'}}}
              examples:
                ok:
                  value: {status: 200, message: '평점 요약', data: {averageScore: 4.2, totalCount: 15, scoreDistribution: {'0': 0, '1': 0, '2': 0, '3': 2, '4': 8, '5': 5}}}
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/ServerError'
  /matches:
    post:
      tags:
        - Match
      summary: '매칭 생성(호스트 팀장 전용)'
      security:
        -
          BearerAuth: []
      description: '호스트 팀의 **팀장**만 생성할 수 있으며, 팀원 11명 이상 조건을 만족해야 합니다.'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MatchCreateRequestV2'
            examples:
              default:
                value:
                  teamId: 66cc7a7f0c2e3a1234567890
                  date: '2025-09-20T10:00:00+09:00'
                  location: '강남구 A구장'
                  players: 11
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {type: object, properties: {id: {type: string}, team: {type: string}, leader: {type: string}, date: {type: string}, location: {type: string}, players: {type: integer}, status: {type: string}, createdAt: {type: string, format: date-time}, updatedAt: {type: string, format: date-time}}}}}
              examples:
                created:
                  value: {status: 201, message: '매칭 요청 생성 성공', data: {id: 66d0..., team: 66cc..., leader: 66c7..., date: '2025-09-20T10:00:00+09:00', location: '강남구 A구장', players: 11, status: pending}}
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/ServerError'
  /matches/list:
    get:
      tags:
        - Match
      summary: '매칭 목록 조회'
      description: '모든 매칭 목록을 최신순으로 조회합니다.'
      security:
        -
          BearerAuth: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {type: array, items: {type: object, properties: {id: {type: string}, team: {type: object, properties: {id: {type: string}, teamName: {type: string}}}, leader: {type: object, properties: {id: {type: string}, username: {type: string}}}, date: {type: string}, location: {type: string}, players: {type: integer}, status: {type: string}, createdAt: {type: string, format: date-time}, updatedAt: {type: string, format: date-time}}}}}}
              examples:
                ok:
                  value: {status: 200, message: '매칭 목록 조회 성공', data: [{id: 66d0..., team: {id: 66cc..., teamName: 'FC Tools'}, leader: {id: 66c7..., username: soccer123}, date: '2025-09-20T10:00:00+09:00', location: '강남구 A구장', players: 11, status: pending}]}
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/ServerError'
  '/matches/{matchId}':
    get:
      tags:
        - Match
      summary: '매칭 상세 조회'
      parameters:
        -
          in: path
          name: matchId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {$ref: '#/components/schemas/Match'}}}
              examples:
                ok:
                  value: {status: 200, message: '상세 조회 성공', data: {id: 66d0..., hostTeamId: 66cc..., place: '강남구 A구장', date: '2025-09-20T10:00:00+09:00', isMatched: false}}
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/ServerError'
  /matches/apply:
    post:
      tags:
        - Match
      summary: '매칭 신청(게스트 팀장 전용)'
      security:
        -
          BearerAuth: []
      description: '게스트 팀 **팀장**만 신청 가능하며, 팀원 11명 이상 조건을 만족해야 합니다.'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MatchApplyRequestV2'
            examples:
              default:
                value:
                  teamId: 66cc7a7f0c2e3a1234567890
                  matchId: 66d0...
                  players: 11
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {type: object, properties: {id: {type: string}, team: {type: string}, matchId: {type: string}, players: {type: integer}}, required: [id, team, matchId, players]}}}
              examples:
                ok:
                  value: {status: 201, message: '매칭 신청 성공', data: {id: 66d1..., team: 66cc..., matchId: 66d0..., players: 11}}
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/ServerError'
  '/matches/{matchId}/participants':
    get:
      tags:
        - Match
      summary: '매칭 참가팀 조회'
      security:
        -
          BearerAuth: []
      description: '특정 매칭에 신청한 게스트 팀 목록을 조회합니다.'
      parameters:
        -
          in: path
          name: matchId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {type: array, items: {type: object, properties: {team: {type: object, properties: {id: {type: string}, teamName: {type: string}}}, players: {type: integer}}}, required: [team, players]}}}
              examples:
                ok:
                  value: {status: 200, message: '매칭 참가팀 조회 성공', data: [{team: {id: 66cc..., teamName: 'FC Tools'}, players: 11}]}
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/ServerError'
  /matches/acceptteam:
    post:
      tags:
        - Match
      summary: '팀 매칭 수락(호스트 팀장 전용)'
      security:
        -
          BearerAuth: []
      description: '호스트 팀장이 게스트 팀의 매칭 신청을 수락합니다.'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MatchAcceptRequest'
            examples:
              default:
                value:
                  matchId: 66d0...
                  teamId: 66cc...
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {type: object, properties: {id: {type: string}, team: {type: string}, acceptedTeam: {type: string}, status: {type: string, example: accepted}}, required: [id, team, acceptedTeam, status]}}}
              examples:
                ok:
                  value: {status: 200, message: '팀 매칭 수락 완료', data: {id: 66d0..., team: 66cc..., acceptedTeam: 66cc..., status: accepted}}
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/ServerError'
  /matches/confirmed:
    get:
      tags:
        - Match
      summary: '성사된 매칭 조회'
      security:
        -
          BearerAuth: []
      description: '수락되어 확정된 모든 매칭 목록을 조회합니다.'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {type: array, items: {type: object, properties: {id: {type: string}, team: {type: object, properties: {id: {type: string}, teamName: {type: string}}}, acceptedTeam: {type: object, properties: {id: {type: string}, teamName: {type: string}}}, date: {type: string}, location: {type: string}, players: {type: integer}, status: {type: string, example: accepted}, createdAt: {type: string, format: date-time}}}}}}
              examples:
                ok:
                  value: {status: 200, message: '성사된 매칭 조회 성공', data: [{id: 66d0..., team: {id: 66cc..., teamName: 'FC Tools'}, acceptedTeam: {id: 66cc..., teamName: 'FC Rivals'}, date: '2025-09-20T10:00:00+09:00', location: '강남구 A구장', players: 11, status: accepted}]}
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/ServerError'
  /auth/phone/request:
    post:
      tags:
        - Phone
      summary: '인증 코드 요청(회원가입 보조)'
      description: '입력한 휴대폰 번호로 6자리 인증 코드를 발송합니다.'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PhoneRequest'
            examples:
              default:
                value:
                  phone: '+821012345678'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {nullable: true}}}
              examples:
                ok:
                  value: {status: 200, message: '인증 코드 발송', data: null, success: true}
        '400':
          $ref: '#/components/responses/BadRequest'
        '429':
          description: 'Too Many Requests'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BaseResponse'
              examples:
                tooMany:
                  value: {status: 429, message: '시도 횟수 초과', data: null, error: rate_limit}
        '500':
          $ref: '#/components/responses/ServerError'
  /auth/phone/verify:
    post:
      tags:
        - Phone
      summary: '인증 코드 검증'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PhoneVerifyRequest'
            examples:
              default:
                value:
                  phone: '+821012345678'
                  code: '123456'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {$ref: '#/components/schemas/PhoneVerifyData'}}}
              examples:
                ok:
                  value: {status: 200, message: '인증 완료', data: {verified: true, expiresAt: null}}
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/ServerError'
  /notifications:
    get:
      tags:
        - Notification
      summary: '알림 목록 조회'
      security:
        -
          BearerAuth: []
      parameters:
        -
          in: query
          name: limit
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 100
          description: '가져올 개수'
        -
          in: query
          name: read
          schema:
            type: boolean
          description: '읽음 여부 필터(true/false)'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {type: array, items: {$ref: '#/components/schemas/NotificationItem'}}}}
              examples:
                ok:
                  value: {status: 200, message: '알림 목록 조회 성공', data: [{id: 66e1..., type: match_apply, title: '매칭 요청이 왔어요!', message: 'FC Tools과 매칭을 잡을까요?', read: false, createdAt: '2025-09-12T10:00:00+09:00', relatedTeam: {id: 66cc..., teamName: 'FC Tools'}}]}
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/ServerError'
  /notifications/unread/count:
    get:
      tags:
        - Notification
      summary: '읽지 않은 알림 개수'
      security:
        -
          BearerAuth: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {$ref: '#/components/schemas/NotificationCount'}}}
              examples:
                ok:
                  value: {status: 200, message: '읽지 않은 알림 개수 조회 성공', data: {count: 3}}
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/ServerError'
  '/notifications/{notificationId}/read':
    patch:
      tags:
        - Notification
      summary: '알림 읽음 처리'
      security:
        -
          BearerAuth: []
      parameters:
        -
          in: path
          name: notificationId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {$ref: '#/components/schemas/NotificationItem'}}}
              examples:
                ok:
                  value: {status: 200, message: '알림 읽음 처리 완료', data: {id: 66e1..., type: team_join_request, title: '가입 요청이 왔어요!', message: '홍길동님의 FC Tools 가입을 승인할까요?', read: true}}
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/ServerError'
  /notifications/read/all:
    patch:
      tags:
        - Notification
      summary: '모든 알림 읽음 처리'
      security:
        -
          BearerAuth: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - {$ref: '#/components/schemas/BaseResponse'}
                  - {type: object, properties: {data: {$ref: '#/components/schemas/NotificationCount'}}}
              examples:
                ok:
                  value: {status: 200, message: '모든 알림 읽음 처리 완료', data: {count: 12}}
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/ServerError'
